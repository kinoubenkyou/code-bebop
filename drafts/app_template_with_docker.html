<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>App Template With Docker</title>
        <link rel="stylesheet" href="../theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
    </head>

    <body>
        <aside class="side-bar">
            <ul>
                <li><a href="../">Code Bebop</a></li>

<li><br></li>
                        <li>
                            <a href="../category/general.html">General</a>
                        </li>
                        <li>
                            <a href="../category/misc.html">Misc</a>
                        </li>
                        <li class="active">
                            <a href="../category/ops.html">Ops</a>
                        </li>


        </ul>
	<div class="credit">
	    <p>Built with <a href="https://github.com/getpelican/pelican">Pelican</a> and <a href="https://github.com/kinoubenkyou/kelican">original theme</a>.</p>
	</div>
        </aside>

    <section class="main">
        <article class="post">
            <div class="title"><a href="#">App Template With Docker</a></div>
            <p>
		24 Jun 2019
		    | <a href="../category/ops.html">Ops</a>
                    |
                        <a href="../tag/bash.html">Bash</a>	    </p>
            <div class="content">
                <p><h1>Docker</h1>
<p>Docker provides containers, a kind of virtual environment, for your app to run on. Containers are create from images, blueprints of the environment. They are usually created from an pre-built os image provided by Docker Hub, followed by layers of instructions to install libraries or frameworks required by your app. These instructions are writen in <code>Dockerfile</code>.</p>
<p>A project usually has more than one app. With Docker, multiple apps can be run together with <code>docker-compose.yml</code> as the config file.</p>
<h1>Create the Template</h1>
<p>You want to have a template app for quick start on future project. To create one, you first have to start with a pre-built os image and manually install all the required packages for your template app until you can successfully start it up. The steps (for an example project) includes:</p>
<ol>
<li>Run <code>docker run -it ubuntu:18.04 bash</code></li>
<li>Run <code>apt update</code></li>
<li>Run <code>apt install -y ruby2.5</code> and install needed packages</li>
<li>Check latest version for rails (assuming it's 5.2.3) and bundler (assuming it's 2.0.2)</li>
<li>Run <code>gem install rails -v 5.2.3</code> and install needed packages</li>
<li>Run <code>gem install bundler -v 2.0.2</code> and install needed packages</li>
<li>Run <code>cd /home</code></li>
<li>Run <code>rails new rails-app</code> and install needed packages</li>
<li>Run <code>bundle exec rails s</code> and install needed packages</li>
<li>Exit the container</li>
</ol>
<p>Then you create the template source code, using the same specific version for the required packages.</p>
<p>After that, you write the instructions to <code>Dockerfile</code> and build the image. The steps (for the example project) includes:</p>
<ol>
<li>Write <code>Dockerfile</code> to the app dir</li>
<li>Run <code>docker build -t rails-app .</code> from the app dir</li>
</ol>
<p>When you want to update your template app with a newer version of its required packages, you will remove the old image and the old app dir, then repeat this process to create a new one.</p>
<p>Use this process for all other apps in the project and also write <code>docker-compose.yml</code>.</p>
<h1>Start a New Project</h1>
<p>The steps:</p>
<ol>
<li>Clone <code>docker-compose.yml</code></li>
<li>Clone and rename the apps, adjust the ports in <code>docker-compose.yml</code></li>
<li>Clone app dirs and rename them</li>
</ol></p>
            </div>
        </article>
    </section>
    </body>
</html>